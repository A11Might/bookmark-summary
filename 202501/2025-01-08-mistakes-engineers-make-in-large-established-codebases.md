# Mistakes engineers make in large established codebases
- URL: https://www.seangoedecke.com/large-established-codebases/
- Added At: 2025-01-08 00:26:22
- [Link To Text](2025-01-08-mistakes-engineers-make-in-large-established-codebases_raw.md)

## TL;DR
在大型代码库中工作具有挑战性，但至关重要。一致性是核心原则，应遵循现有模式以避免不一致性。理解代码库的使用情况、谨慎管理依赖、删除代码时需谨慎，并保持小规模变更以促进团队协作。大型代码库通常产生公司主要收入，深入理解是拆分的前提。

## Summary
1. **大型代码库的挑战**：
   - **定义**：大型代码库通常包含数百万行代码，由数百名工程师共同维护，且代码库的初始版本至少有十年历史。
   - **学习难度**：在大型代码库中工作是软件工程师最难掌握的技能之一，无法通过开源项目或个人项目提前练习。

2. **主要错误：不一致性**：
   - **常见错误**：工程师倾向于在实现新功能时忽略现有代码库，以保持代码的整洁，但这会导致不一致性。
   - **重要性**：
     - **避免意外**：一致性可以避免代码库中的“地雷”，如未知的特殊用户类型或内部工具的特殊处理。
     - **长期维护**：一致性有助于减缓代码库的混乱，并为未来的改进提供便利。
   - **建议**：在实现新功能前，应先研究代码库中的现有模式，并尽可能遵循这些模式。

3. **其他重要注意事项**：
   - **理解服务的使用情况**：
     - **关键路径**：了解哪些端点最常被使用，哪些是关键路径，以及服务的延迟要求。
     - **避免意外影响**：避免在关键路径上进行“微小调整”，以免引发重大问题。
   - **测试的局限性**：
     - **状态复杂性**：大型代码库积累了大量的状态，无法测试所有组合。
     - **防御性编程**：应测试关键路径，依赖监控和逐步发布来捕捉问题。
   - **依赖管理**：
     - **谨慎引入新依赖**：依赖会带来长期的安全漏洞和更新成本，应选择广泛使用且可靠的依赖。
   - **代码删除**：
     - **风险与收益**：删除代码是高风险工作，但值得进行。应首先通过生产环境中的调用者分析确保安全。
   - **小规模PR与团队协作**：
     - **小规模变更**：在大型项目中，应保持变更小且易于阅读，以便其他团队的领域专家能够发现问题。

4. **为何要在大型代码库中工作**：
   - **价值来源**：大型代码库通常产生公司90%的价值，是公司收入的主要来源。
   - **拆分代码库的前提**：要拆分大型代码库，必须先深入理解它。没有对大型代码库的深入了解，无法成功拆分。

5. **总结**：
   - **重要性**：大型代码库通常支付你的薪水，因此值得投入时间学习如何在其上工作。
   - **一致性**：一致性是最重要的原则，应始终遵循现有模式。
   - **研究与理解**：在开始新功能前，必须研究代码库中的现有实现，并理解代码库的生产环境使用情况。
   - **测试与监控**：无法测试所有情况，应依赖监控来捕捉问题。
   - **代码删除**：有机会时应删除代码，但需非常谨慎。
   - **团队协作**：应使领域专家更容易发现你的错误。
